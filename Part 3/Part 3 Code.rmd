---
output: pdf_document
---

# Impact of Inflation On Stock Market Performance -- A Canadian Perspective (With Code)
**Although this is not the full analysis for part 3, you may find the notes in this document helpful as supplements to the full analysis.**

## Setup

```{r}
# Import data
df <- read.csv("/Users/daniel/Dev/STA302-FINAL-PROJECT/Part 1/cleaned_df.csv")
# Verifies that the data is imported correctly
str(df)
```
Because inflation target is the midpoint between the lower and upper inflation target, will exclude the upper inflation target to avoid perfect collinearity.
```{r}
df <- df[, !(names(df) %in% c("INDINF_UPPTARGET"))]
```
Now we will separate the dataset into training set and test set

```{r}
# Create a 50/50 split
set.seed(1)
# Opted for a higher number of samples to include in the training dataset
train_df <- df[sample(1:nrow(df), ceiling(nrow(df)/2), replace=F), ]
test_df <- df[which(!(df$X %in% train_df$X)), ]

# Delete the index column that was used to separate the training and testing data sets
train_df <- train_df[!(names(train_df) %in% c("X"))]
test_df <- test_df[!(names(test_df) %in% c("X"))]

# Verify the training and testing data sets have the right number of samples
dim(train_df)
dim(test_df)
```

## Data Modelling On Training Set
### EDA
#### Histograms
```{r}
par(mfrow=c(2,2))
for (i in 1:ncol(train_df)) {
  hist(train_df[, i], main=paste("Histogram of", names(train_df)[i]), xlab=names(train_df)[i])
}
```
From the above histograms, we can see that most variables look relatively normal. However, for lower and upper targets, the histogram looks substantially skewed. We need to watch out for its implications in our analysis. 

#### Scatterplots
```{r, fig.width=6, fig.height=4}
par(mfrow=c(2,2))
for (i in c(1:3, 5:length(train_df))) {
  plot(train_df[,i], train_df$Monthly_Change, main=paste(names(train_df)[4], "vs", names(train_df)[i]), xlab=names(train_df)[i], ylab=names(train_df)[5])
}
```
We can see that there are some points of concern appearing in the scatterplots, we will investigate them further later on

## Model Fitting
We will start with all available predictors
```{r}
mod1 <- lm(train_df$Monthly_Change ~ ., data=train_df)
summary(mod1)
```
















